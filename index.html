{
  "name": "buscador-inteligente-diplomado-linux",
  "version": "0.1.0",
  "private": true,
  "scripts": {
    "dev": "vite",
    "build": "vite build",
    "preview": "vite preview"
  },
  "dependencies": {
    "fuse.js": "^6.6.2",
    "react": "^18.2.0",
    "react-dom": "^18.2.0"
  },
  "devDependencies": {
    "@types/react": "^18.0.28",
    "@types/react-dom": "^18.0.11",
    "typescript": "^5.1.6",
    "vite": "^5.0.0",
    "@vitejs/plugin-react": "^4.0.0"
  }
}

<!doctype html>
<html lang="es">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0" />
    <title>Buscador Inteligente — Diplomado Linux</title>
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>

import React from "react";
import { createRoot } from "react-dom/client";
import App from "./App";
import "./styles.css";

createRoot(document.getElementById("root")!).render(
  <React.StrictMode>
    <App />
  </React.StrictMode>
);

import React, { useEffect, useState } from "react";
import Fuse from "fuse.js";
import SearchBox from "./components/SearchBox";
import VoiceButton from "./components/VoiceButton";
import Results from "./components/Results";
import data from "./data/questions.json";

type Item = {
  id: number;
  number?: number;
  topic?: string;
  question: string;
  answer: string;
};

const fuse = new Fuse(data as Item[], {
  keys: [
    { name: "question", weight: 0.8 },
    { name: "answer", weight: 0.6 },
    { name: "topic", weight: 0.4 }
  ],
  includeMatches: true,
  includeScore: true,
  threshold: 0.35,
  useExtendedSearch: true
});

export default function App() {
  const [query, setQuery] = useState("");
  const [results, setResults] = useState<Fuse.FuseResult<Item>[]>([]);
  const [lastQueryByVoice, setLastQueryByVoice] = useState("");

  useEffect(() => {
    if (query.trim() === "") {
      setResults([]);
      return;
    }
    // If query looks like an exact search (wrap with quotes), use exact match mode
    const res = fuse.search(query);
    setResults(res.slice(0, 20)); // limit
  }, [query]);

  return (
    <div style={{ padding: 20, fontFamily: "Inter, Arial, sans-serif", maxWidth: 900, margin: "0 auto" }}>
      <h1>Buscador Inteligente — Diplomado Linux</h1>
      <p>Escribe o habla tu pregunta. El buscador entiende palabras clave aunque no estén exactas y busca en preguntas y respuestas.</p>

      <div style={{ display: "flex", gap: 8, alignItems: "center" }}>
        <SearchBox value={query} onChange={setQuery} placeholder="Ej.: ¿qué es systemd y para qué sirve?" />
        <VoiceButton onResult={(text) => { setQuery(text); setLastQueryByVoice(text); }} />
      </div>

      {lastQueryByVoice ? <p style={{ color: "#666" }}>Última búsqueda por voz: «{lastQueryByVoice}»</p> : null}

      <Results results={results} query={query} />
    </div>
  );
}

        import React from "react";

type Props = {
  value: string;
  onChange: (v: string) => void;
  placeholder?: string;
};

export default function SearchBox({ value, onChange, placeholder }: Props) {
  return (
    <input
      value={value}
      onChange={(e) => onChange(e.target.value)}
      placeholder={placeholder}
      style={{
        flex: 1,
        padding: "10px 12px",
        fontSize: 16,
        borderRadius: 6,
        border: "1px solid #ccc"
      }}
      onKeyDown={(e) => {
        if (e.key === "Escape") onChange("");
      }}
    />
  );
}

        import React, { useEffect, useState } from "react";

type Props = {
  onResult: (text: string) => void;
};

export default function VoiceButton({ onResult }: Props) {
  const [supported, setSupported] = useState(false);
  const [listening, setListening] = useState(false);
  const [transcript, setTranscript] = useState("");

  useEffect(() => {
    const w = window as any;
    setSupported(!!(w.SpeechRecognition || w.webkitSpeechRecognition));
  }, []);

  useEffect(() => {
    let recognition: any;
    const w = window as any;
    const Rec = w.SpeechRecognition || w.webkitSpeechRecognition;
    if (!Rec) return;
    recognition = new Rec();
    recognition.lang = "es-ES";
    recognition.interimResults = true;
    recognition.onresult = (ev: any) => {
      let text = "";
      for (let i = 0; i < ev.results.length; i++) {
        text += ev.results[i][0].transcript;
      }
      setTranscript(text);
      if (ev.results[ev.results.length - 1].isFinal) {
        onResult(text.trim());
        setListening(false);
      }
    };
    recognition.onend = () => setListening(false);

    if (listening) recognition.start();
    else recognition.stop?.();

    return () => recognition.stop?.();
  }, [listening, onResult]);

  if (!supported) {
    return <button disabled style={{ padding: "8px 12px" }}>Voz no soportada</button>;
  }

  return (
    <div style={{ display: "flex", gap: 8, alignItems: "center" }}>
      <button
        onClick={() => setListening((s) => !s)}
        style={{
          padding: "8px 12px",
          background: listening ? "#e74c3c" : "#2ecc71",
          color: "white",
          border: "none",
          borderRadius: 6,
          cursor: "pointer"
        }}
      >
        {listening ? "Detener" : "Hablar"}
      </button>
      <small style={{ color: "#666" }}>{transcript}</small>
    </div>
  );
}

        import React from "react";
import Fuse from "fuse.js";

type Item = {
  id: number;
  number?: number;
  topic?: string;
  question: string;
  answer: string;
};

type Props = {
  results: Fuse.FuseResult<Item>[];
  query: string;
};

function highlight(text: string, matches?: Fuse.FuseResultMatch[]) {
  if (!matches || matches.length === 0) return text;
  // Build a set of ranges
  const ranges: Array<{ start: number; end: number }> = [];
  matches.forEach((m) => {
    m.indices?.forEach(([s, e]) => ranges.push({ start: s, end: e + 1 }));
  });
  if (ranges.length === 0) return text;
  // Merge ranges
  ranges.sort((a, b) => a.start - b.start);
  const merged: typeof ranges = [];
  for (const r of ranges) {
    if (!merged.length || r.start > merged[merged.length - 1].end) merged.push(r);
    else merged[merged.length - 1].end = Math.max(merged[merged.length - 1].end, r.end);
  }
  // Build highlighted string
  let out = "";
  let last = 0;
  for (const r of merged) {
    out += escapeHtml(text.slice(last, r.start));
    out += "<mark>" + escapeHtml(text.slice(r.start, r.end)) + "</mark>";
    last = r.end;
  }
  out += escapeHtml(text.slice(last));
  return out;
}

function escapeHtml(s: string) {
  return s.replace(/[&<>"']/g, (c) => ({ "&": "&amp;", "<": "&lt;", ">": "&gt;", '"': "&quot;", "'": "&#39;" }[c]!));
}

export default function Results({ results, query }: Props) {
  if (!query || query.trim() === "") return null;
  if (results.length === 0) {
    return <div style={{ marginTop: 20 }}>No se encontraron resultados. Intenta usar otras palabras clave.</div>;
  }

  return (
    <div style={{ marginTop: 20 }}>
      <h2>Resultados ({results.length})</h2>
      <div style={{ display: "grid", gap: 12 }}>
        {results.map((r) => {
          const item = r.item;
          return (
            <div key={item.id} style={{ padding: 12, borderRadius: 8, border: "1px solid #eee", background: "#fafafa" }}>
              <div style={{ display: "flex", justifyContent: "space-between", gap: 12 }}>
                <div>
                  <strong>{item.topic ?? "Tema desconocido"}</strong> — Pregunta #{item.number ?? item.id}
                </div>
                <div style={{ color: "#666" }}>Confianza: {(1 - (r.score ?? 0)).toFixed(2)}</div>
              </div>

              <h3 style={{ margin: "8px 0" }} dangerouslySetInnerHTML={{ __html: highlight(item.question, r.matches?.filter(m => m.key === "question")) }} />

              <div dangerouslySetInnerHTML={{ __html: highlight(item.answer, r.matches?.filter(m => m.key === "answer")) }} style={{ color: "#222" }} />

              <details style={{ marginTop: 8 }}>
                <summary style={{ cursor: "pointer" }}>Ver coincidencias y metadatos</summary>
                <pre style={{ whiteSpace: "pre-wrap", fontSize: 12, color: "#444" }}>{JSON.stringify(r, null, 2)}</pre>
              </details>
            </div>
          );
        })}
      </div>
    </div>
  );
}
      [
  {
    "id": 1,
    "number": 1,
    "topic": "TEMA 1: FILOSOFÍA LINUX",
    "question": "¿Qué es Linux y cuál es su propósito principal?",
    "answer": "Linux es un sistema operativo de código abierto cuyo propósito es administrar los recursos del hardware y permitir la ejecución de programas."
  },
  {
    "id": 2,
    "number": 2,
    "topic": "TEMA 1: FILOSOFÍA LINUX",
    "question": "¿Qué significa que Linux sea de código abierto?",
    "answer": "Significa que su código fuente puede ser estudiado, modificado y redistribuido libremente."
  },
  {
    "id": 3,
    "number": 3,
    "topic": "TEMA 1: FILOSOFÍA LINUX",
    "question": "¿Quién creó el kernel de Linux?",
    "answer": "Linus Torvalds creó el kernel de Linux en 1991."
  },
  {
    "id": 4,
    "number": 4,
    "topic": "TEMA 1: FILOSOFÍA LINUX",
    "question": "¿Qué es el software libre según la filosofía de Linux?",
    "answer": "Es software que garantiza la libertad de usar, estudiar, modificar y compartir."
  },
  {
    "id": 5,
    "number": 5,
    "topic": "TEMA 1: FILOSOFÍA LINUX",
    "question": "¿Cuál es la diferencia entre software libre y software propietario?",
    "answer": "El software libre permite modificar su código, el propietario no."
  },
  {
    "id": 6,
    "number": 6,
    "topic": "TEMA 1: FILOSOFÍA LINUX",
    "question": "¿Qué es el proyecto GNU?",
    "answer": "Es un proyecto iniciado por Richard Stallman para crear un sistema operativo completamente libre."
  },
  {
    "id": 7,
    "number": 7,
    "topic": "TEMA 1: FILOSOFÍA LINUX",
    "question": "¿Qué relación existe entre GNU y Linux?",
    "answer": "Linux usa las herramientas de GNU para formar el sistema operativo completo GNU/Linux."
  },
  {
    "id": 8,
    "number": 8,
    "topic": "TEMA 1: FILOSOFÍA LINUX",
    "question": "¿Qué es una distribución de Linux?",
    "answer": "Es una versión de Linux que incluye el kernel, programas, bibliotecas y gestor de paquetes."
  },
  {
    "id": 9,
    "number": 9,
    "topic": "TEMA 1: FILOSOFÍA LINUX",
    "question": "¿Por qué existen muchas distribuciones de Linux?",
    "answer": "Porque cualquiera puede crear una basada en necesidades específicas."
  },
  {
    "id": 10,
    "number": 10,
    "topic": "TEMA 1: FILOSOFÍA LINUX",
    "question": "¿Qué es la licencia GPL?",
    "answer": "Es una licencia que garantiza que el software siga siendo libre incluso si se modifica."
  }
  /* Nota: Aquí hay una muestra de 10 entradas. Reemplaza o expande este archivo con el dataset completo (620 entradas) que proporcionaste:
     estructura: [{ id, number, topic, question, answer }, ...]
     si quieres, puedo generar el archivo completo y añadírtelo directamente. */
]

      body { background: #f7f8fa; color: #111; }
h1 { margin-bottom: 4px; }
mark { background: #ffd54f; padding: 0 2px; border-radius: 2px; }

      
